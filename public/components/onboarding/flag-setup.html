<div class="onboarding flag-setup">
    <link rel="stylesheet" href="/styles/instructor-components/onboarding.css">
    <link rel="stylesheet" href="/styles/instructor-components/report-instructor.css">
    <link rel="stylesheet" href="/styles/chat-components/flag-message.css">
    <link rel="stylesheet" href="/styles/modal-overlay.css">
    
    <style>
    /* Demo empty state styling */
    .demo-empty-state {
        background: var(--chat-bg);
        border-radius: 10px;
        border: 1px solid var(--border-color);
        padding: 30px;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-top: 20px;
    }
    
    .empty-state-content {
        max-width: 500px;
        margin: 0 auto;
    }
    
    .empty-state-icon {
        font-size: 48px;
        margin-bottom: 15px;
    }
    
    .empty-state-content h4 {
        color: var(--color-chbe-green);
        margin-bottom: 15px;
        font-size: 18px;
    }
    
    .empty-state-list {
        text-align: left;
        margin: 15px 0;
        padding-left: 20px;
    }
    
    .empty-state-list li {
        margin: 8px 0;
        color: var(--text-secondary);
    }
    
    .empty-state-note {
        font-style: italic;
        color: var(--text-secondary);
        margin-top: 15px;
        font-size: 14px;
    }
    
    /* Completion message styling */
    .completion-note {
        background: rgba(92, 138, 58, 0.1);
        border-left: 4px solid var(--color-chbe-green);
        padding: 15px;
        margin-top: 20px;
        border-radius: 6px;
    }
    
    .completion-cta {
        text-align: center;
        margin-top: 20px;
        padding: 15px;
        background: var(--gingham-color);
        border-radius: 8px;
    }
    
    .completion-list li {
        margin: 10px 0;
    }
    </style>
    
    <!-- Left Steps Panel -->
    <div class="onboarding-steps-panel">
        
        <div class="steps-header">
            <div class="logo-box">
                <i data-feather="flag"></i>
                <div class="logo-text">
                    <span>EngE-AI</span>
                    <p>Instructor Mode: Flag Management</p>
                </div>
            </div>
        </div>

        <h2>Learn how to manage student flags</h2>
        
        <div class="steps-list">
            <!-- Step 1: Welcome -->
            <div class="step-item" data-step="1">
                <div class="step-indicator">
                    <div class="step-circle completed">
                        <span class="step-number">1</span>
                    </div>
                    <div class="step-line"></div>
                </div>
                <div class="step-content">
                    <h3>Welcome</h3>
                    <p>Introduction to flag management</p>
                </div>
            </div>

            <!-- Step 2: Flag Types -->
            <div class="step-item" data-step="2">
                <div class="step-indicator">
                    <div class="step-circle completed">
                        <span class="step-number">2</span>
                    </div>
                    <div class="step-line"></div>
                </div>
                <div class="step-content">
                    <h3>Flag Types</h3>
                    <p>Understanding different flag categories</p>
                </div>
            </div>

            <!-- Step 3: Resolving Flags -->
            <div class="step-item" data-step="3">
                <div class="step-indicator">
                    <div class="step-circle completed">
                        <span class="step-number">3</span>
                    </div>
                    <div class="step-line"></div>
                </div>
                <div class="step-content">
                    <h3>Resolving Flags</h3>
                    <p>How to resolve student flags</p>
                </div>
            </div>

            <!-- Step 4: Editing Comments -->
            <div class="step-item" data-step="4">
                <div class="step-indicator">
                    <div class="step-circle completed">
                        <span class="step-number">4</span>
                    </div>
                    <div class="step-line"></div>
                </div>
                <div class="step-content">
                    <h3>Edit Comments</h3>
                    <p>How to edit flag responses</p>
                </div>
            </div>

            <!-- Step 5: Congratulations -->
            <div class="step-item" data-step="5">
                <div class="step-indicator">
                    <div class="step-circle current">
                        <span class="step-number">5</span>
                    </div>
                </div>
                <div class="step-content">
                    <h3>Complete</h3>
                    <p>Flag management setup finished</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Content Area -->
    <div class="onboarding-content-area">
        <!-- Help Menu -->
        <div class="help-menu">
            <button class="help-btn" id="helpBtn">
                <i data-feather="info"></i>
                <span>Help</span>
            </button>
        </div>

        <!-- Step 1: Welcome -->
        <div class="content-step active" id="content-step-1">
            <div class="content-step-inner">
                <div class="step-header">
                    <h1>Welcome to Flag Management</h1>
                    <p>Learn how to effectively manage and respond to student flags</p>
                </div>
                
                <div class="welcome-content">
                    <div class="welcome-message">
                        <h3>Welcome, Professor! Let's enhance your teaching toolkit</h3>
                        <p>As an instructor, you play a crucial role in maintaining the quality and accuracy of the AI tutor. This brief tutorial will help you master the flag management system, enabling you to provide valuable feedback that directly improves the learning experience for your students.</p>
                        
                        <div class="demo-explanation">
                            <h4>Your instructor capabilities:</h4>
                            <ul class="feature-list">
                                <li>Review and respond to student concerns about AI responses</li>
                                <li>Maintain academic integrity and engineering accuracy</li>
                                <li>Provide guidance that improves the AI tutor's performance</li>
                                <li>Edit and refine your responses for maximum impact</li>
                                <li>Ensure a safe, inclusive, and educationally sound environment</li>
                            </ul>
                        </div>
                        
                        <div class="demo-explanation" style="margin-top: 2rem; background: rgba(92, 138, 58, 0.05); border-left: 4px solid var(--color-chbe-green);">
                            <h4>💡 Pro Tip:</h4>
                            <p>Your responses to flagged messages directly influence the AI tutor's learning. Thoughtful feedback helps create a more accurate and helpful assistant for all your students.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 2: Flag Types -->
        <div class="content-step" id="content-step-2">
            <div class="content-step-inner">
                <div class="step-header">
                    <h1>Understanding Flag Types</h1>
                    <p>Learn about the different categories of flags students can report</p>
                </div>
                
                <div class="demo-section">
                    <div class="demo-explanation">
                        <h3>Flag Categories</h3>
                        <p>Students can flag messages for various reasons. Understanding these categories helps you provide appropriate responses and improve the AI tutor's performance.</p>
                    </div>
                    
                    <div class="demo-interactive">
                        <h3>Flag Types Accordion</h3>
                        
                        <!-- Accordion for flag types -->
                        <div class="flag-types-accordion">
                            <div class="accordion-item">
                                <button class="accordion-header" data-target="safety-incorrect">
                                    <span class="accordion-icon">📊</span>
                                    <span class="accordion-title">Calculation & Concept Errors</span>
                                    <i data-feather="chevron-down" class="accordion-chevron"></i>
                                </button>
                                <div class="accordion-content" id="safety-incorrect">
                                    <p>Wrong calculations, formulas, or engineering principles</p>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <button class="accordion-header" data-target="harassment-edi">
                                    <span class="accordion-icon">🚫</span>
                                    <span class="accordion-title">Harassment & EDI Violations</span>
                                    <i data-feather="chevron-down" class="accordion-chevron"></i>
                                </button>
                                <div class="accordion-content" id="harassment-edi">
                                    <p>Contains harassment, or content that violates EDI (Equity, Diversity, Inclusion) principles</p>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <button class="accordion-header" data-target="off-topic">
                                    <span class="accordion-icon">📝</span>
                                    <span class="accordion-title">Off-Topic & Inappropriate</span>
                                    <i data-feather="chevron-down" class="accordion-chevron"></i>
                                </button>
                                <div class="accordion-content" id="off-topic">
                                    <p>Response veers into personal opinions, political views, or non-academic discussions inappropriate for engineering education</p>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <button class="accordion-header" data-target="academic-dishonesty">
                                    <span class="accordion-icon">🎓</span>
                                    <span class="accordion-title">Academic Dishonesty</span>
                                    <i data-feather="chevron-down" class="accordion-chevron"></i>
                                </button>
                                <div class="accordion-content" id="academic-dishonesty">
                                    <p>Provides content that appears copied from sources without attribution or encourages academic dishonesty</p>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <button class="accordion-header" data-target="interface-bug">
                                    <span class="accordion-icon">🐛</span>
                                    <span class="accordion-title">Interface Bug</span>
                                    <i data-feather="chevron-down" class="accordion-chevron"></i>
                                </button>
                                <div class="accordion-content" id="interface-bug">
                                    <p>Interface bugs or usability issues</p>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <button class="accordion-header" data-target="other">
                                    <span class="accordion-icon">💬</span>
                                    <span class="accordion-title">Other Issues</span>
                                    <i data-feather="chevron-down" class="accordion-chevron"></i>
                                </button>
                                <div class="accordion-content" id="other">
                                    <p>Others</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Resolving Flags -->
        <div class="content-step" id="content-step-3">
            <div class="content-step-inner">
                <div class="step-header">
                    <h1>Resolving Student Flags</h1>
                    <p>Learn how to review and resolve flagged messages</p>
                </div>
                
                <div class="demo-section">
                    <div class="demo-explanation">
                        <h3>Flag Resolution Process</h3>
                        <p>When students flag messages, they appear in your "Unresolved" section. You can review the flagged content and provide appropriate responses to help improve the AI tutor's performance.</p>
                    </div>
                    
                    <div class="demo-interactive">
                        <h3>Demo: Flag Resolution Interface</h3>
                        
                        <!-- Demo flag resolution interface with report card style -->
                        <div class="reports-list">
                            <!-- Unresolved Flag Example -->
                            <div class="report-card" data-flag-type="calculation-error" data-report-id="1" onclick="toggleReportCard(this)">
                                <div class="report-header-row">
                                    <div class="report-time">2:30 PM, March 19, 2026</div>
                                    <div class="report-type">Flag: Calculation & Concept Errors</div>
                                </div>
                                <div class="chat-content">
                                    "The stress in a beam under bending is calculated as σ = M*y/I, where M is the moment, y is the distance from neutral axis, and I is the moment of inertia. For a rectangular beam, I = b³h/12."
                                </div>
                                <div class="report-footer">
                                    <div class="student-name">Student User</div>
                                    <div class="status-badge">🏳 Unresolved</div>
                                    <div class="expand-arrow">▼</div>
                                </div>
                                
                                <div class="expanded-content" style="display: none;">
                                    <div class="response-section">
                                        <div class="response-header">Response:</div>
                                        <textarea class="response-textarea" id="demo-response-textarea-step3" name="demo-response-step3" placeholder="Write your response to this flag..." aria-label="Response text for flag resolution"></textarea>
                                        <div class="response-actions">
                                            <button class="resolve-button" data-report-id="1" data-status="unresolved" onclick="handleDemoResolve(this)">Resolve</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Empty state for resolved explanation -->
                            <div class="demo-empty-state" id="demo-empty-state" style="display: none;">
                                <div class="empty-state-content">
                                    <div class="empty-state-icon">✅</div>
                                    <h4>Flag Resolved!</h4>
                                    <p>This flag has been moved to the <strong>"Resolved"</strong> section where you can:</p>
                                    <ul class="empty-state-list">
                                        <li>Review all resolved flags</li>
                                        <li>Edit your responses if needed</li>
                                        <li>Track your flag resolution history</li>
                                    </ul>
                                    <p class="empty-state-note">The resolved flags help you monitor patterns and improve the AI tutor's performance over time.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 4: Editing Comments -->
        <div class="content-step" id="content-step-4" data-requires-completion="3">
            <div class="content-step-inner">
                <div class="step-header">
                    <h1>Editing Your Responses</h1>
                    <p>Learn how to modify and update your flag responses</p>
                </div>
                
                <div class="demo-section">
                    <div class="demo-explanation">
                        <h3>Response Management</h3>
                        <p>You can edit your responses to flagged messages even after they've been resolved. This allows you to refine your feedback or add additional information as needed.</p>
                    </div>
                    
                    <div class="demo-interactive">
                        <h3>Demo: Editing Responses</h3>
                        
                        <div class="reports-list">
                            <div class="report-card expanded" data-flag-type="calculation-error" data-report-id="3" onclick="toggleReportCard(this)">
                                <div class="report-header-row">
                                    <div class="report-time">3:15 PM, March 19, 2026</div>
                                    <div class="report-type">Flag: Calculation & Concept Errors</div>
                                </div>
                                <div class="chat-content">
                                    "The moment of inertia for a rectangular beam is I = b³h/12, which is the standard formula used in structural engineering."
                                </div>
                                <div class="report-footer">
                                    <div class="student-name">Student User</div>
                                    <div class="status-badge">✅ Resolved</div>
                                    <div class="expand-arrow">▲</div>
                                </div>
                                
                                <div class="expanded-content">
                                    <div class="response-section">
                                        <div class="response-header">Response:</div>
                                        <div class="full-chat-content" id="editable-response">
                                            <span id="submitted-response-placeholder">Your submitted response will appear here after completing Step 3</span>
                                        </div>
                                        <div class="response-actions">
                                            <button class="resolve-button" data-report-id="3" data-status="resolved" onclick="toggleEditMode(this)">Edit Response</button>
                                            <button class="resolve-button" data-report-id="3" data-status="resolved" onclick="handleDemoSave(this)" style="display: none;">Save Changes</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Empty state for Step 4 completion -->
                            <div class="demo-empty-state" id="demo-empty-state-step4" style="display: none;">
                                <div class="empty-state-content">
                                    <div class="empty-state-icon">✨</div>
                                    <h4>Response Updated!</h4>
                                    <p>Now you know how to edit and update your responses to flagged messages. This gives you the flexibility to refine your feedback as needed.</p>
                                    <ul class="empty-state-list">
                                        <li>You can edit responses even after they're resolved</li>
                                        <li>This helps you provide better feedback over time</li>
                                        <li>Your edits improve the AI tutor's learning</li>
                                    </ul>
                                    <p class="empty-state-note">Think about how this editing capability might be useful when you want to add more detail or correct your initial response.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 5: Congratulations -->
        <div class="content-step" id="content-step-5" data-requires-completion="4">
            <div class="content-step-inner">
                <div class="step-header">
                    <h1>Flag Management Complete!</h1>
                    <p>You're now ready to effectively manage student flags</p>
                </div>
                
                <div class="completion-content">
                    <div class="completion-message">
                        <div class="success-icon">🎉</div>
                        <h3>Flag Management Tutorial Complete!</h3>
                        <p>Congratulations! You have successfully completed the flag management onboarding session. You now have all the knowledge needed to effectively manage student flags in EngE-AI!</p>
                        <ul class="completion-list">
                            <li>✅ Learned about different flag categories and their meanings</li>
                            <li>✅ Understood how to resolve flagged messages with appropriate responses</li>
                            <li>✅ Discovered how to edit and update your responses</li>
                            <li>✅ Gained insight into best practices for flag management</li>
                        </ul>
                        <div class="completion-note">
                            <p><strong>You're all set!</strong> You can now confidently use the flag management system to help improve the AI tutor's performance through your thoughtful feedback.</p>
                        </div>
                    </div>
                    
                    <div class="next-steps">
                        <h4>Ready to Start!</h4>
                        <p>Your flag management system is now active and ready to use:</p>
                        <ul>
                            <li>🔍 Monitor the "Unresolved" section for new student flags</li>
                            <li>✍️ Provide thoughtful responses to help improve AI performance</li>
                            <li>📊 Use flag data to identify patterns and areas for improvement</li>
                            <li>✏️ Edit your responses as needed to provide better feedback</li>
                            <li>🎯 Help create a more accurate and helpful AI tutor for all students</li>
                        </ul>
                        <div class="completion-cta">
                            <p><strong>Happy flagging! 🚩</strong></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="onboarding-navigation">
            <button class="nav-btn btn-back" id="backBtn" style="display: none;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15,18 9,12 15,6"></polyline>
                </svg>
                Back
            </button>
            <button class="nav-btn btn-next" id="nextBtn">
                Next
                <i data-feather="chevron-right"></i>
            </button>
        </div>
    </div>

    <!-- Help Content Templates (Hidden) -->
    <div id="help-templates" style="display: none;">
        <!-- Step 1 Help -->
        <div id="help-step-1">
            <p><strong>Welcome to Flag Management!</strong></p>
            <p>This tutorial will teach you how to effectively manage student flags in EngE-AI. Flags help improve the AI tutor's performance by identifying areas that need attention.</p>
            <p><strong>What you'll learn:</strong></p>
            <ul>
                <li>Understanding different types of student flags</li>
                <li>How to resolve flags with appropriate responses</li>
                <li>Editing and updating your responses</li>
                <li>Best practices for flag management</li>
            </ul>
        </div>

        <!-- Step 2 Help -->
        <div id="help-step-2">
            <p><strong>Understanding Flag Types</strong></p>
            <p>Students can flag messages for various reasons. Each flag type helps identify different issues that need attention:</p>
            <ul>
                <li><strong>Calculation & Concept Errors:</strong> Incorrect calculations or flawed engineering concepts</li>
                <li><strong>Harassment & EDI:</strong> Inappropriate or discriminatory content</li>
                <li><strong>Off-Topic:</strong> Non-academic or inappropriate discussions</li>
                <li><strong>Academic Dishonesty:</strong> Plagiarism or cheating encouragement</li>
                <li><strong>Interface Bug:</strong> Technical issues with the system</li>
                <li><strong>Other:</strong> Issues not covered by other categories</li>
            </ul>
        </div>

        <!-- Step 3 Help -->
        <div id="help-step-3">
            <p><strong>Resolving Student Flags</strong></p>
            <p>When students flag messages, they appear in your "Unresolved" section. To resolve a flag:</p>
            <ol>
                <li>Review the flagged message and the student's reason</li>
                <li>Provide a thoughtful response addressing the issue</li>
                <li>Click "Mark as Resolved" to complete the process</li>
            </ol>
            <p><strong>Tips for good responses:</strong></p>
            <ul>
                <li>Acknowledge the student's concern</li>
                <li>Provide clear explanation or correction</li>
                <li>Thank them for helping improve the system</li>
            </ul>
        </div>

        <!-- Step 4 Help -->
        <div id="help-step-4">
            <p><strong>Editing Your Responses</strong></p>
            <p>You can edit your responses even after they've been resolved:</p>
            <ul>
                <li>Find the resolved flag in your flag history</li>
                <li>Click "Edit Response" to modify your feedback</li>
                <li>Save your changes to update the response</li>
            </ul>
            <p>This is useful for refining your feedback or adding additional information as you learn more about the issue.</p>
        </div>

        <!-- Step 5 Help -->
        <div id="help-step-5">
            <p><strong>Flag Management Complete!</strong></p>
            <p>Congratulations! You now have all the knowledge needed to effectively manage student flags.</p>
            <p><strong>Remember:</strong></p>
            <ul>
                <li>Check your "Unresolved" section regularly</li>
                <li>Provide thoughtful, constructive responses</li>
                <li>Use flag data to identify improvement areas</li>
                <li>Edit responses as needed to provide better feedback</li>
            </ul>
            <p>Your feedback helps continuously improve the AI tutor's performance for all students.</p>
        </div>
    </div>
</div>

